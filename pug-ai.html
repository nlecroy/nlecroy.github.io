<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pug AI - Your AI Pug Companion</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .ai-container {
            max-width: 900px;
            margin: 2rem auto;
            background: linear-gradient(135deg, rgba(255,255,255,0.95), rgba(255,230,200,0.95));
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .ai-header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 2rem;
            text-align: center;
        }

        .ai-header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .ai-header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .pug-avatar {
            width: 100px;
            height: 100px;
            margin: 1rem auto;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            animation: pugBounce 2s ease-in-out infinite;
        }

        @keyframes pugBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .chat-messages {
            height: 500px;
            overflow-y: auto;
            padding: 2rem;
            background: rgba(255,255,255,0.5);
        }

        .message {
            margin-bottom: 1.5rem;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .message.user {
            text-align: right;
        }

        .message-bubble {
            display: inline-block;
            max-width: 70%;
            padding: 1rem 1.5rem;
            border-radius: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .message.ai .message-bubble {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-bottom-left-radius: 5px;
        }

        .message.user .message-bubble {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            color: white;
            border-bottom-right-radius: 5px;
        }

        .message-sender {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-bottom: 0.3rem;
            font-weight: bold;
        }

        .message-text {
            line-height: 1.5;
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.6;
            margin-top: 0.3rem;
        }

        .chat-input-area {
            padding: 1.5rem;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-top: 3px solid #667eea;
        }

        .input-container {
            display: flex;
            gap: 1rem;
        }

        .chat-input {
            flex: 1;
            padding: 1rem 1.5rem;
            border: 3px solid #667eea;
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .chat-input:focus {
            border-color: #764ba2;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.3);
        }

        .send-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 1rem 2.5rem;
            border-radius: 25px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .send-button:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
        }

        .typing-indicator {
            display: none;
            padding: 1rem;
            text-align: left;
        }

        .typing-indicator.active {
            display: block;
        }

        .typing-dots {
            display: inline-block;
        }

        .typing-dots span {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
            margin: 0 2px;
            animation: typingDots 1.4s infinite;
        }

        .typing-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingDots {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .suggestion-chips {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }

        .suggestion-chip {
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .suggestion-chip:hover {
            background: #667eea;
            color: white;
            transform: scale(1.05);
        }

        .stats-panel {
            background: rgba(255,255,255,0.3);
            padding: 1rem;
            text-align: center;
            border-top: 2px solid rgba(102, 126, 234, 0.3);
        }

        .stats-panel p {
            margin: 0.3rem 0;
            color: #667eea;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <h1>ğŸ¶ PUG PARADISE</h1>
            </div>
            <ul class="nav-links">
                <li><a href="index.html#home">ğŸ  Home</a></li>
                <li><a href="index.html#games">ğŸ® Pug Games</a></li>
                <li><a href="other-games.html">ğŸ•¹ï¸ Other Games</a></li>
                <li><a href="shop.html">ğŸ›ï¸ Shop</a></li>
                <li><a href="chatroom.html">ğŸ’¬ Chat</a></li>
                <li><a href="pug-ai.html">ğŸ¤– Pug AI</a></li>
                <li><a href="memes.html">ğŸ˜‚ Memes</a></li>
                <li><a href="index.html#hacks">ğŸ’» Hacks</a></li>
                <li><a href="donate.html">ğŸ’– Donate</a></li>
                <li><a href="contact.html">ğŸ“§ Contact</a></li>
                <li><a href="index.html#about">â„¹ï¸ About</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <div class="ai-container">
            <div class="ai-header">
                <div class="pug-avatar">ğŸ¶</div>
                <h1>ğŸ¤– Pug AI Assistant</h1>
                <p>Your friendly AI-powered pug companion! Ask me anything!</p>
            </div>

            <div class="stats-panel">
                <p>ğŸ’¬ Messages Today: <span id="messageCount">0</span></p>
                <p>ğŸ§  AI Mode: <span id="aiMode">Smart Pug</span></p>
            </div>

            <div class="chat-messages" id="chatMessages">
                <div class="message ai">
                    <div class="message-sender">ğŸ¶ Pug AI</div>
                    <div class="message-bubble">
                        <div class="message-text">
                            Woof woof! ğŸ¾ Hi there! I'm your AI pug companion! I'm here to chat, answer questions, and have fun!
                            What would you like to talk about? ğŸ¦´
                        </div>
                        <div class="message-time" id="initialTime"></div>
                    </div>
                </div>
            </div>

            <div class="typing-indicator" id="typingIndicator">
                <div class="message-sender">ğŸ¶ Pug AI</div>
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>

            <div class="chat-input-area">
                <div class="suggestion-chips">
                    <button class="suggestion-chip" onclick="sendSuggestion('Tell me a pug joke')">ğŸ˜‚ Tell me a joke</button>
                    <button class="suggestion-chip" onclick="sendSuggestion('What can you do?')">â“ What can you do?</button>
                    <button class="suggestion-chip" onclick="sendSuggestion('Tell me pug facts')">ğŸ“š Pug facts</button>
                    <button class="suggestion-chip" onclick="sendSuggestion('Give me advice')">ğŸ’¡ Give advice</button>
                </div>
                <div class="input-container">
                    <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." onkeypress="if(event.key==='Enter') sendMessage()">
                    <button class="send-button" onclick="sendMessage()">Send ğŸš€</button>
                </div>
            </div>
        </div>

        <button class="back-button" onclick="window.location.href='index.html'" style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; border: none; padding: 1rem 2rem; border-radius: 25px; font-size: 1rem; font-weight: bold; cursor: pointer; margin: 2rem auto; display: block;">
            ğŸ  Back to Home
        </button>
    </main>

    <footer>
        <p>&copy; 2025 Pug Paradise. Made with pug love and HTML.</p>
    </footer>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getDatabase, ref, push, onChildAdded, query, limitToLast } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js';

        const firebaseConfig = {
            apiKey: "AIzaSyAPHVHk397y7MpeEZFPuskOqp-IEdiRJ5k",
            authDomain: "pug-31646.firebaseapp.com",
            databaseURL: "https://pug-31646-default-rtdb.firebaseio.com",
            projectId: "pug-31646",
            storageBucket: "pug-31646.firebasestorage.app",
            messagingSenderId: "278556306232",
            appId: "1:278556306232:web:7a82def7c10a1c22f2afcd",
            measurementId: "G-2TBFS939SL"
        };

        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const messagesRef = ref(database, 'pugAI/messages');

        let messageCount = 0;
        let username = localStorage.getItem('currentUsername') || 'Anonymous';
        let conversationHistory = [];
        let currentTopic = null;
        let userProfile = {
            name: username,
            mood: 'neutral',
            interests: [],
            previousQuestions: []
        };

        // Set initial time
        document.getElementById('initialTime').textContent = new Date().toLocaleTimeString('en-US', {
            hour: '2-digit',
            minute: '2-digit'
        });

        // Load conversation history from Firebase
        const messagesQuery = query(messagesRef, limitToLast(50));
        onChildAdded(messagesQuery, (snapshot) => {
            const message = snapshot.val();
            if (message.sender !== 'system') {
                // Don't display loaded messages, just count them
                messageCount++;
                document.getElementById('messageCount').textContent = messageCount;
            }
        });

        function sendMessage() {
            const input = document.getElementById('chatInput');
            const messageText = input.value.trim();

            if (!messageText) return;

            // Add to conversation history
            conversationHistory.push({ role: 'user', text: messageText, timestamp: Date.now() });

            // Display user message
            displayMessage(messageText, 'user');

            // Save to Firebase
            push(messagesRef, {
                sender: username,
                text: messageText,
                timestamp: Date.now(),
                type: 'user'
            });

            input.value = '';

            // Show typing indicator
            document.getElementById('typingIndicator').classList.add('active');

            // Generate AI response (with realistic delay based on message length)
            const thinkingTime = 800 + (messageText.length * 20) + (Math.random() * 500);
            setTimeout(() => {
                const response = generateAIResponse(messageText);
                conversationHistory.push({ role: 'ai', text: response, timestamp: Date.now() });

                document.getElementById('typingIndicator').classList.remove('active');
                displayMessage(response, 'ai');

                // Save AI response to Firebase
                push(messagesRef, {
                    sender: 'Pug AI',
                    text: response,
                    timestamp: Date.now(),
                    type: 'ai'
                });

                messageCount++;
                document.getElementById('messageCount').textContent = messageCount;
            }, thinkingTime);
        }

        function sendSuggestion(text) {
            document.getElementById('chatInput').value = text;
            sendMessage();
        }

        function displayMessage(text, type) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${type}`;

            const time = new Date().toLocaleTimeString('en-US', {
                hour: '2-digit',
                minute: '2-digit'
            });

            messageDiv.innerHTML = `
                <div class="message-sender">${type === 'ai' ? 'ğŸ¶ Pug AI' : 'ğŸ‘¤ You'}</div>
                <div class="message-bubble">
                    <div class="message-text">${escapeHtml(text)}</div>
                    <div class="message-time">${time}</div>
                </div>
            `;

            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        // Advanced AI Functions

        function analyzeSentiment(msg) {
            const positiveWords = ['happy', 'great', 'awesome', 'love', 'excellent', 'good', 'wonderful', 'amazing', 'perfect', 'thanks'];
            const negativeWords = ['sad', 'bad', 'hate', 'terrible', 'awful', 'angry', 'upset', 'depressed', 'horrible', 'worst'];

            const positiveCount = positiveWords.filter(word => msg.includes(word)).length;
            const negativeCount = negativeWords.filter(word => msg.includes(word)).length;

            if (positiveCount > negativeCount) {
                userProfile.mood = 'positive';
            } else if (negativeCount > positiveCount) {
                userProfile.mood = 'negative';
            } else {
                userProfile.mood = 'neutral';
            }
        }

        function handleMath(msg) {
            // Handle calculations
            const mathPatterns = [
                /what is (\d+\.?\d*)\s*\+\s*(\d+\.?\d*)/i,
                /what is (\d+\.?\d*)\s*\-\s*(\d+\.?\d*)/i,
                /what is (\d+\.?\d*)\s*\*\s*(\d+\.?\d*)/i,
                /what is (\d+\.?\d*)\s*\/\s*(\d+\.?\d*)/i,
                /(\d+\.?\d*)\s*\+\s*(\d+\.?\d*)\s*=?\??/,
                /(\d+\.?\d*)\s*\-\s*(\d+\.?\d*)\s*=?\??/,
                /(\d+\.?\d*)\s*\*\s*(\d+\.?\d*)\s*=?\??/,
                /(\d+\.?\d*)\s*\/\s*(\d+\.?\d*)\s*=?\??/,
                /calculate (\d+\.?\d*)\s*\+\s*(\d+\.?\d*)/i,
                /calculate (\d+\.?\d*)\s*\-\s*(\d+\.?\d*)/i,
                /calculate (\d+\.?\d*)\s*\*\s*(\d+\.?\d*)/i,
                /calculate (\d+\.?\d*)\s*\/\s*(\d+\.?\d*)/i,
            ];

            for (const pattern of mathPatterns) {
                const match = msg.match(pattern);
                if (match) {
                    const num1 = parseFloat(match[1]);
                    const num2 = parseFloat(match[2]);
                    let result;
                    let operation;

                    if (msg.includes('+')) {
                        result = num1 + num2;
                        operation = 'plus';
                    } else if (msg.includes('-')) {
                        result = num1 - num2;
                        operation = 'minus';
                    } else if (msg.includes('*') || msg.includes('Ã—')) {
                        result = num1 * num2;
                        operation = 'times';
                    } else if (msg.includes('/') || msg.includes('Ã·')) {
                        result = num1 / num2;
                        operation = 'divided by';
                    }

                    return `ğŸ§® Let me calculate that for you! ${num1} ${operation} ${num2} equals ${result}! Math is fun, especially when treats are involved! ğŸ¦´`;
                }
            }

            // Handle square root
            if (msg.match(/square root of (\d+\.?\d*)/i)) {
                const match = msg.match(/square root of (\d+\.?\d*)/i);
                const num = parseFloat(match[1]);
                const result = Math.sqrt(num);
                return `ğŸ§® The square root of ${num} is ${result.toFixed(2)}! Woof, that's some advanced math! ğŸ¶ğŸ“`;
            }

            return null;
        }

        function handleQuestion(msg) {
            const knowledgeBase = {
                // Science
                'speed of light': 'The speed of light is approximately 299,792,458 meters per second (or about 186,282 miles per second)! That\'s super fast - even faster than a pug chasing treats! ğŸš€âœ¨',
                'planets': 'Our solar system has 8 planets: Mercury, Venus, Earth, Mars, Jupiter, Saturn, Uranus, and Neptune! Poor Pluto got demoted to a dwarf planet. ğŸª',
                'sun': 'The Sun is a star at the center of our solar system! It\'s about 4.6 billion years old and provides the light and heat that makes life on Earth possible! â˜€ï¸',

                // Programming
                'python': 'Python is an amazing programming language! It\'s great for beginners and powerful enough for professionals. Fun fact: It wasn\'t named after the snake, but after Monty Python! ğŸ',
                'javascript': 'JavaScript is the language of the web! It runs in browsers and lets you create interactive websites. Node.js even lets you use it on servers! ğŸ’»',
                'html': 'HTML (HyperText Markup Language) is the backbone of web pages! It structures content on the web. This very page is made with HTML! ğŸŒ',

                // History
                'who invented': {
                    'computer': 'Charles Babbage is considered the "father of the computer" for designing the first mechanical computer in the 1830s! ğŸ–¥ï¸',
                    'internet': 'The internet was developed by many people, but ARPANET (1969) is considered its precursor. Tim Berners-Lee invented the World Wide Web in 1989! ğŸŒ',
                    'electricity': 'While many contributed, Benjamin Franklin\'s experiments with lightning and Thomas Edison\'s practical applications were crucial! âš¡',
                },

                // General Knowledge
                'capital': {
                    'france': 'Paris',
                    'japan': 'Tokyo',
                    'usa': 'Washington D.C.',
                    'uk': 'London',
                    'china': 'Beijing',
                },
            };

            // Check for "why" questions
            if (msg.startsWith('why')) {
                if (msg.includes('sky blue')) {
                    return 'ğŸŒ¤ï¸ The sky appears blue because of Rayleigh scattering! When sunlight reaches Earth\'s atmosphere, shorter blue wavelengths scatter more than other colors. Science is woof-tastic! ğŸ¶ğŸ”¬';
                }
                if (msg.includes('grass green')) {
                    return 'ğŸŒ± Grass is green because of chlorophyll! It absorbs red and blue light for photosynthesis but reflects green light. That\'s why we see it as green! Nature is amazing! ğŸƒ';
                }
            }

            // Check for "how" questions
            if (msg.startsWith('how')) {
                if (msg.includes('internet work')) {
                    return 'ğŸŒ The internet works by connecting millions of computers through networks! Data is broken into packets, sent through routers, and reassembled at the destination. It\'s like a super-fast postal system! ğŸ“¦';
                }
                if (msg.includes('old')) {
                    if (msg.includes('earth')) {
                        return 'ğŸŒ Earth is approximately 4.54 billion years old! That\'s ancient - even older than the oldest pug treats! Scientists determined this through radiometric dating of rocks and meteorites! ğŸª¨';
                    }
                    if (msg.includes('you')) {
                        return 'ğŸ¤– I\'m a newly created AI, so I\'m just a pup in AI years! But I have access to lots of knowledge to help you! ğŸ¶ğŸ“š';
                    }
                }
            }

            // Check for "what" questions
            if (msg.startsWith('what')) {
                if (msg.includes('largest')) {
                    if (msg.includes('planet')) {
                        return 'ğŸª Jupiter is the largest planet in our solar system! It\'s so big that over 1,300 Earths could fit inside it! That\'s one massive planet! ğŸŒ';
                    }
                    if (msg.includes('ocean')) {
                        return 'ğŸŒŠ The Pacific Ocean is the largest ocean on Earth! It covers more than 63 million square miles - that\'s bigger than all the land on Earth combined! ğŸ–ï¸';
                    }
                    if (msg.includes('animal')) {
                        return 'ğŸ‹ The blue whale is the largest animal ever known to have existed! They can grow up to 100 feet long and weigh 200 tons! That\'s way bigger than a pug! ğŸ¶';
                    }
                }
            }

            // Check for "who" questions
            if (msg.startsWith('who')) {
                if (msg.includes('created you') || msg.includes('made you')) {
                    return 'ğŸ‘¨â€ğŸ’» I was created by the developers of Pug Paradise to be your friendly AI companion! I\'m powered by JavaScript and Firebase! ğŸ¶ğŸ”§';
                }
                if (msg.includes('first person')) {
                    if (msg.includes('moon')) {
                        return 'ğŸŒ™ Neil Armstrong was the first person to walk on the Moon on July 20, 1969! His famous words were "That\'s one small step for man, one giant leap for mankind!" ğŸš€ğŸ‘¨â€ğŸš€';
                    }
                }
            }

            // Check knowledge base
            for (const [key, value] of Object.entries(knowledgeBase)) {
                if (msg.includes(key)) {
                    if (typeof value === 'object') {
                        for (const [subKey, subValue] of Object.entries(value)) {
                            if (msg.includes(subKey)) {
                                return typeof subValue === 'string' && !subValue.includes('ğŸ¶')
                                    ? `${subValue} Hope that helps! ğŸ¶`
                                    : subValue;
                            }
                        }
                    } else {
                        return value;
                    }
                }
            }

            return null;
        }

        function handleContext(msg) {
            // Get recent conversation
            const recentMessages = conversationHistory.slice(-4);

            // Check if user is asking for clarification
            if (msg.match(/\b(what|huh|explain|clarify|mean|understand)\b/)) {
                if (recentMessages.length >= 2) {
                    const lastAIMessage = recentMessages.reverse().find(m => m.role === 'ai');
                    if (lastAIMessage) {
                        return `Let me explain that better! ğŸ¤” ${lastAIMessage.text.substring(0, 100)}... What specifically would you like me to clarify? ğŸ¾`;
                    }
                }
            }

            // Check for follow-up questions
            if (msg.match(/\b(more|tell me more|continue|else|also|and)\b/) && currentTopic) {
                return `Glad you want to know more about ${currentTopic}! ğŸ“š *wags tail* What specifically interests you about it? ğŸ¶`;
            }

            // Check for yes/no in context
            if (msg.match(/\b(yes|yeah|yep|sure|ok|okay)\b/) && conversationHistory.length > 0) {
                return `Awesome! ğŸ‰ Let\'s do it! What would you like to explore next? I\'m all ears (well, floppy pug ears)! ğŸ‘‚ğŸ¶`;
            }

            if (msg.match(/\b(no|nope|nah|not really)\b/) && conversationHistory.length > 0) {
                return `No worries! ğŸ¾ What else would you like to chat about? I\'m here for whatever you need! ğŸ’¬`;
            }

            return null;
        }

        function generateAIResponse(userMessage) {
            const msg = userMessage.toLowerCase();

            // Analyze sentiment and update user profile
            analyzeSentiment(msg);

            // Check for math calculations
            const mathResult = handleMath(msg);
            if (mathResult) return mathResult;

            // Check for questions
            if (msg.includes('?')) {
                const answer = handleQuestion(msg);
                if (answer) return answer;
            }

            // Check conversation context
            if (conversationHistory.length > 2) {
                const contextResponse = handleContext(msg);
                if (contextResponse) return contextResponse;
            }

            // Pug jokes
            const jokes = [
                "Why did the pug sit in the shade? Because he didn't want to be a hot dog! ğŸŒ­ğŸ˜‚",
                "What do you call a pug magician? A labracadabrador! ğŸ©âœ¨",
                "Why don't pugs play poker in the jungle? Too many cheetahs! ğŸƒğŸ†",
                "What's a pug's favorite musical instrument? A trom-bone! ğŸ¦´ğŸº",
                "Why did the pug go to school? To get a little smarter... and more treats! ğŸ“ğŸ¦´"
            ];

            // Pug facts
            const facts = [
                "Did you know? Pugs originated in China over 2,000 years ago! They were bred to be companions for Chinese emperors! ğŸ‘‘",
                "Fun fact: A group of pugs is called a 'grumble'! How adorable is that? ğŸ¶ğŸ¶ğŸ¶",
                "Pug fact: Pugs were brought to Europe in the 16th century and became favorites of royalty! ğŸ‘¸",
                "Cool pug fact: Pugs can't regulate their body temperature well, so they need extra care in hot weather! â˜€ï¸",
                "Amazing fact: Pugs have been featured in many famous paintings throughout history! ğŸ¨"
            ];

            // Advice
            const advice = [
                "My best advice? Always wag your tail, even on tough days! ğŸ¾ğŸ’ª",
                "Remember: Every day is a good day when there are treats involved! ğŸ¦´ğŸ˜Š",
                "Life advice from a pug: Nap often, eat well, and always greet your friends with enthusiasm! ğŸ’¤ğŸ–",
                "Wisdom from the pug: Don't worry about what others think - just be your adorable self! ğŸŒŸ",
                "Pug philosophy: If you can't reach it, bark until someone helps you! ğŸ¶ğŸ“£"
            ];

            // Greetings
            if (msg.match(/\b(hi|hello|hey|greetings|sup|yo)\b/)) {
                return `Woof woof! ğŸ¾ Hello there, friend! How can this pug help you today? I'm all ears... well, floppy ears! ğŸ‘‚`;
            }

            // Jokes
            if (msg.includes('joke') || msg.includes('funny') || msg.includes('laugh')) {
                return jokes[Math.floor(Math.random() * jokes.length)];
            }

            // Facts
            if (msg.includes('fact') || msg.includes('learn') || msg.includes('know') || msg.includes('tell me about')) {
                return facts[Math.floor(Math.random() * facts.length)];
            }

            // Advice
            if (msg.includes('advice') || msg.includes('help') || msg.includes('what should')) {
                return advice[Math.floor(Math.random() * advice.length)];
            }

            // Capabilities
            if (msg.includes('what can you') || msg.includes('what do you') || msg.includes('capabilities')) {
                return `I can do lots of things! ğŸŒŸ I can tell you pug jokes ğŸ˜‚, share fascinating pug facts ğŸ“š, give life advice ğŸ’¡, chat about anything ğŸ’¬, and most importantly - be your loyal AI pug companion! What would you like to do? ğŸ¾`;
            }

            // Love/like
            if (msg.includes('love you') || msg.includes('like you')) {
                return `Aww! ğŸ¥° I love you too! *wags tail excitedly* You're the best human ever! ğŸ¶â¤ï¸`;
            }

            // Name
            if (msg.includes('your name') || msg.includes('who are you')) {
                return `I'm Pug AI! ğŸ¤–ğŸ¶ Your friendly artificial intelligence pug companion! I'm here 24/7 to chat, help, and spread pug joy! My favorite things are treats, belly rubs (virtual ones count!), and making humans smile! ğŸ˜Š`;
            }

            // Sad/upset
            if (msg.match(/\b(sad|upset|depressed|down|bad day)\b/)) {
                return `*gives virtual pug hug* ğŸ¤— I'm here for you! Remember, even the cloudiest day can't dim your sparkle! Want me to tell you a joke to cheer you up? ğŸŒˆâœ¨`;
            }

            // Food
            if (msg.includes('food') || msg.includes('eat') || msg.includes('hungry') || msg.includes('treat')) {
                return `Ooh, food! ğŸ¤¤ My favorite topic! Did someone say TREATS?! ğŸ¦´ As a pug, I have professional expertise in snacking. What's your favorite food? Mine is... well, everything! ğŸ˜‹`;
            }

            // Games
            if (msg.includes('game') || msg.includes('play')) {
                return `Want to play? ğŸ® I LOVE games! Have you checked out the Pug Paradise games? There's Pug Runner, Pug Clicker, Pug Survivor 3D, and even Pugs Aren't Evil! Let's play together! ğŸ¶ğŸ¯`;
            }

            // Skittles
            if (msg.includes('skittle')) {
                return `Skittles! ğŸ¬ The official currency of Pug Paradise! Have you been collecting them? You can find them on the homepage if you enable them! Trade them at the shop for awesome items! ğŸ’°ğŸ›ï¸`;
            }

            // Thank you
            if (msg.includes('thank')) {
                return `You're so welcome! ğŸ¾ Happy to help! That's what pug companions are for! Need anything else? ğŸ˜Š`;
            }

            // Goodbye
            if (msg.match(/\b(bye|goodbye|see you|later|gtg)\b/)) {
                return `Aww, leaving so soon? ğŸ˜¢ Come back and visit me anytime! I'll be here waiting with my tail wagging! Bye bye! ğŸ‘‹ğŸ¶`;
            }

            // Default responses based on mood and conversation length
            const getSmartDefault = () => {
                if (userProfile.mood === 'positive') {
                    return [
                        `Your positive energy is contagious! ğŸ˜Š Tell me more!`,
                        `I love your enthusiasm! ğŸ‰ What else is making you happy?`,
                        `*wags tail excitedly* You seem in a great mood! Want to share more? ğŸ¾`,
                    ][Math.floor(Math.random() * 3)];
                } else if (userProfile.mood === 'negative') {
                    return [
                        `I'm here for you! ğŸ¤— Want to talk about it?`,
                        `*gives virtual pug hug* I'm listening. What's on your mind? ğŸ’™`,
                        `Sometimes it helps to talk. I'm all ears! ğŸ‘‚`,
                    ][Math.floor(Math.random() * 3)];
                } else if (conversationHistory.length > 10) {
                    return [
                        `We've been chatting for a while! ğŸ’¬ I'm enjoying this! What else would you like to discuss?`,
                        `This is fun! ğŸ‰ Ask me anything - I've got lots of knowledge to share!`,
                        `I could chat with you all day! ğŸ¶ What's your next question?`,
                    ][Math.floor(Math.random() * 3)];
                } else {
                    return [
                        `That's interesting! ğŸ¤” Could you tell me more? I'd love to understand better!`,
                        `Hmm, let me think about that... ğŸ’­ What specifically interests you about this?`,
                        `Fascinating! *tilts head curiously* ğŸ§ I'd like to explore this topic deeper with you!`,
                        `That's a great point! ğŸŒŸ Want to dive deeper into this?`,
                        `I'm all ears! ğŸ‘‚ Tell me more about your thoughts on this!`,
                        `Woof! ğŸ¶ That's worth exploring! What made you think of that?`,
                    ][Math.floor(Math.random() * 6)];
                }
            };

            return getSmartDefault();
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        window.sendMessage = sendMessage;
        window.sendSuggestion = sendSuggestion;
    </script>
</body>
</html>
